replicaCount: 2

image:
  repository: ""  # Set via --set or CI/CD
  pullPolicy: IfNotPresent
  tag: "latest"

serviceAccount:
  create: true
  annotations:
    eks.amazonaws.com/role-arn: ""  # Set via --set

namespace:
  create: true
  name: sre-assistant
  istioInjection: true

bedrock:
  agentId: ""  # Set via --set
  agentAliasId: "production"
  region: "us-gov-west-1"

secret:
  # Method: "native" (K8s secret), "external-secrets", or "csi-driver"
  method: "native"
  secretKey: ""  # Set via --set (for native method)
  
  # External Secrets Operator configuration
  externalSecrets:
    enabled: false
    secretStore: "aws-secrets-manager"  # ClusterSecretStore name
    secretName: "sre-assistant-flask-secret"  # AWS Secrets Manager secret name
    secretKey: "secret-key"  # Key in AWS secret
  
  # Secrets Store CSI Driver configuration (FedRAMP compliant)
  csiDriver:
    enabled: false
    secretProviderClass: "sre-assistant-secrets"
    secretName: "sre-assistant-flask-secret"  # AWS Secrets Manager secret ARN
    mountPath: "/mnt/secrets"
    secretKey: "secret-key"

service:
  type: ClusterIP
  port: 80
  targetPort: 8080

ingress:
  enabled: true
  className: alb
  annotations:
    alb.ingress.kubernetes.io/scheme: internal
    alb.ingress.kubernetes.io/target-type: ip
    alb.ingress.kubernetes.io/healthcheck-path: /api/health
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTPS":443}]'
  host: sre-assistant.internal.example.com
  certificateArn: ""  # Set via --set

resources:
  requests:
    cpu: 250m
    memory: 512Mi
  limits:
    cpu: 500m
    memory: 1Gi

livenessProbe:
  httpGet:
    path: /api/health
    port: 8080
  initialDelaySeconds: 30
  periodSeconds: 10

readinessProbe:
  httpGet:
    path: /api/health
    port: 8080
  initialDelaySeconds: 5
  periodSeconds: 5

autoscaling:
  enabled: false
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

podIdentity:
  # Add sre-assistant namespace to pod_identity_namespaces in terraform.tfvars
  # Terraform will create the Pod Identity association automatically
  enabled: true
